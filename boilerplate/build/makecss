#! /bin/sh

# HTML5 boilerplate tools
# This should be uncommented and changed to reflect your own tools install
#alias cssminify='java -jar ~/projects/html5-boilerplate/build/tools/yuicompressor-2.4.7.jar'

# minify and concatenate CSS files
echo "Minification ...\n"
cssminify ../css/base.css > tmp
echo "\n" >> tmp
cssminify ../css/layout.css >> tmp
echo "\n" >> tmp
cssminify ../css/module.css >> tmp
echo "\n" >> tmp
cssminify ../css/state.css >> tmp
echo "\n" >> tmp
cssminify ../css/theme.css >> tmp
echo "\n" >> tmp

# remove previous file if needed
if [ -e cssbuild.php ]
then
    old=`cat cssbuild.php | cut -d \' -f4`
    if [ ${old} -a -e ../css/${old}.css ] 
    then
         rm ../css/${old}.css
         echo "../css/${old}.css removed"
    fi
fi

# rename the new file from its MD5 hash
hash=`md5sum tmp|cut -c 1-8`
mv tmp ../css/${hash}.css
echo "Minified file ../css/${hash}.css created successfully\n"

# declare the file name in PHP
echo "<?php define('CSSBUILD', '${hash}'); ?>" > cssbuild.php
